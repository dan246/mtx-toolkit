<h1 align="center">MTX Toolkit</h1>

<p align="center">
  <strong>ä¼æ¥­ç´š MediaMTX ä¸²æµå¯é æ€§ç®¡ç†å¹³å°</strong>
</p>

<p align="center">
  <a href="README.md">English</a> | <a href="README.zh-TW.md">ç¹é«”ä¸­æ–‡</a>
</p>

<p align="center">
  <a href="#åŠŸèƒ½ç‰¹è‰²">åŠŸèƒ½</a> â€¢
  <a href="#æˆªåœ–">æˆªåœ–</a> â€¢
  <a href="#å¿«é€Ÿé–‹å§‹">å¿«é€Ÿé–‹å§‹</a> â€¢
  <a href="#æ¶æ§‹">æ¶æ§‹</a> â€¢
  <a href="#api-åƒè€ƒ">API</a>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License">
  <img src="https://img.shields.io/badge/python-3.12+-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/react-18+-61DAFB.svg" alt="React">
  <img src="https://img.shields.io/badge/docker-ready-2496ED.svg" alt="Docker">
</p>

---

## æ¦‚è¿°

MTX Toolkit æ˜¯ä¸€å€‹å°ˆç‚º MediaMTX è¨­è¨ˆçš„ä¼æ¥­ç´šä¸²æµå¯é æ€§ç®¡ç†å¹³å°ï¼Œæä¾›å³æ™‚ç›£æ§ã€è‡ªå‹•ä¿®å¾©ã€é…ç½®ç®¡ç†èˆ‡å¤šç¯€é»ç®¡ç†åŠŸèƒ½ã€‚æ”¯æ´åŒæ™‚ç›£æ§**ä¸Šåƒå°æ”å½±æ©Ÿ**ï¼Œä¸¦åœ¨ 10 ç§’å…§å®Œæˆå…¨é¢å¥åº·æª¢æŸ¥ã€‚

## åŠŸèƒ½ç‰¹è‰²

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **å³æ™‚é è¦½** | ç¶²æ ¼ç¸®åœ–æª¢è¦–ï¼Œæ»‘é¼ æ‡¸åœæ’­æ”¾ HLS é è¦½ï¼Œé»æ“Šå…¨è¢å¹•æ’­æ”¾ |
| **é›™å±¤å¥åº·æª¢æŸ¥** | å¿«é€Ÿæª¢æŸ¥ï¼ˆAPIï¼Œæ¯ 10 ç§’ï¼‰+ æ·±åº¦æª¢æŸ¥ï¼ˆffprobeï¼Œæ¯ 5 åˆ†é˜ï¼‰ |
| **å³æ™‚ç›£æ§** | æ”¯æ´ 1000+ ä¸²æµï¼Œæ¯«ç§’ç´šç‹€æ…‹æ›´æ–° |
| **è‡ªå‹•ä¿®å¾©** | æ™ºæ…§åˆ†ç´šé‡è©¦ï¼ŒæŒ‡æ•¸é€€é¿ + æŠ–å‹•æ¼”ç®—æ³• |
| **Fleet ç®¡ç†** | å¤šç¯€é»çµ±ä¸€ç®¡ç†ï¼Œè·¨ç’°å¢ƒéƒ¨ç½²ï¼ˆdev/staging/prodï¼‰ |
| **Config-as-Code** | Terraform é¢¨æ ¼çš„ plan/apply å·¥ä½œæµç¨‹ |
| **éŒ„å½±ç®¡ç†** | ç›®éŒ„æƒæã€ç·šä¸Šæ’­æ”¾ã€æœå°‹èˆ‡åˆ†é ã€è‡ªå‹•æ¸…ç†èˆ‡æ­¸æª” |
| **å¤šèªç³»** | ç¹é«”ä¸­æ–‡ / English |

## æˆªåœ–

### å„€è¡¨æ¿
å³æ™‚ç›£æ§æ‰€æœ‰ä¸²æµç‹€æ…‹ã€å¥åº·åˆ†ä½ˆã€æ´»å‹•å‘Šè­¦èˆ‡æœ€è¿‘äº‹ä»¶ã€‚

![Dashboard](docs/screenshots/dashboard.png)

### å³æ™‚é è¦½
æ‰€æœ‰ä¸²æµçš„ç¶²æ ¼æª¢è¦–ï¼Œè‡ªå‹•ç”Ÿæˆç¸®åœ–ã€‚æ»‘é¼ æ‡¸åœæ’­æ”¾å³æ™‚ HLS ä¸²æµï¼Œé»æ“Šé–‹å•Ÿå…¨è¢å¹•æ’­æ”¾å™¨ï¼ˆå«éŸ³è¨Šæ§åˆ¶ï¼‰ã€‚

![Preview](docs/screenshots/preview.png)

### ç¯€é»ç®¡ç†
å¤šç¯€é»çµ±ä¸€ç®¡ç†ï¼Œé¡¯ç¤ºæ¯å€‹ç¯€é»çš„ä¸²æµå¥åº·ç‹€æ³ï¼ˆå¥åº·/é™ç´š/ä¸å¥åº·ï¼‰ã€‚

![Fleet Management](docs/screenshots/fleet.png)

### ä¸²æµç®¡ç†
å®Œæ•´çš„ä¸²æµ CRUD æ“ä½œï¼Œæ”¯æ´ç‹€æ…‹ç¯©é¸ã€FPS/ä½å…ƒç‡ç›£æ§ã€æ‰‹å‹•æ¢æ¸¬èˆ‡ä¿®å¾©ã€‚

![Streams](docs/screenshots/streams.png)

### éŒ„å½±ç®¡ç†
éŒ„å½±æª”æ¡ˆç®¡ç†ï¼Œæ”¯æ´ç›®éŒ„æƒæã€ç·šä¸Šæ’­æ”¾ï¼ˆTS è‡ªå‹•è½‰æª” MP4ï¼‰ã€è·¨åˆ†é æœå°‹ã€åˆ†é ç€è¦½ã€ç£ç¢Ÿä½¿ç”¨é‡ç›£æ§èˆ‡è‡ªå‹•æ¸…ç†ã€‚

![Recordings](docs/screenshots/recordings.png)

## å¥åº·æª¢æŸ¥ç³»çµ±

### ä¸²æµç‹€æ…‹

| ç‹€æ…‹ | é¡è‰² | èªªæ˜ |
|------|:----:|------|
| **Healthy** | ğŸŸ¢ | ä¸²æµæ­£å¸¸ï¼Œå¯æ’­æ”¾ |
| **Degraded** | ğŸŸ¡ | é€£ç·šä¸­ã€ç›£è½å¾…æ©Ÿã€æˆ–æš«æ™‚ä¸å¯ç”¨ |
| **Unhealthy** | ğŸ”´ | è·¯å¾‘ä¸å­˜åœ¨æˆ–å®Œå…¨é›¢ç·š |
| **Unknown** | âšª | å°šæœªæª¢æŸ¥ |

### é›™å±¤æª¢æŸ¥æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Quick Check - ä¸»è¦ç›£æ§                        â”‚
â”‚                      (æ¯ 10 ç§’)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ MediaMTX â”‚â”€â”€â”€â–¶â”‚  API Query  â”‚â”€â”€â”€â–¶â”‚ ready: true/false â”‚    â”‚
â”‚  â”‚   API    â”‚    â”‚ /v3/paths   â”‚    â”‚   ç‹€æ…‹æ›´æ–°        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                    â¬‡ æ‰€æœ‰ä¸²æµ ~0.2 ç§’                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Deep Check - è©³ç´°è¨ºæ–·                         â”‚
â”‚                      (æ¯ 5 åˆ†é˜)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  RTSP   â”‚â”€â”€â”€â–¶â”‚   ffprobe   â”‚â”€â”€â”€â–¶â”‚ FPS, è§£æåº¦,      â”‚    â”‚
â”‚  â”‚ Stream  â”‚    â”‚  TCP Mode   â”‚    â”‚ ç·¨ç¢¼, ä½å…ƒç‡      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                    â¬‡ ä¸¦è¡ŒåŸ·è¡Œ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›£æ§å®¹é‡

| ä¸²æµæ•¸é‡ | å¿«é€Ÿæª¢æŸ¥æ™‚é–“ |
|:-------:|:-----------:|
| 200 | ~0.2 ç§’ |
| 1,000 | ~1 ç§’ |
| 5,000 | ~5 ç§’ |

## å¿«é€Ÿé–‹å§‹

### ç³»çµ±éœ€æ±‚

- Docker & Docker Compose
- é‹è¡Œä¸­çš„ MediaMTX å¯¦ä¾‹
- 2GB+ RAM

### 1. å•Ÿå‹•æœå‹™

```bash
git clone <repo-url> mtx-toolkit
cd mtx-toolkit
docker compose up -d
```

### 2. å­˜å–ä»‹é¢

| æœå‹™ | ç¶²å€ |
|------|------|
| **å‰ç«¯ UI** | http://localhost:3001 |
| **å¾Œç«¯ API** | http://localhost:5002 |

### 3. æ–°å¢ç¯€é»

é€é UI æˆ– API æ–°å¢ä½ çš„ MediaMTX ç¯€é»ï¼š

```bash
curl -X POST http://localhost:5002/api/fleet/nodes \
  -H "Content-Type: application/json" \
  -d '{
    "name": "main-mediamtx",
    "api_url": "http://your-mediamtx:9998",
    "rtsp_url": "rtsp://your-mediamtx:8554",
    "environment": "production"
  }'
```

### 4. åŒæ­¥ä¸²æµ

```bash
curl -X POST http://localhost:5002/api/fleet/sync-all
```

## æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MTX Toolkit                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Frontend â”‚  â”‚ Backend  â”‚  â”‚  Celery  â”‚  â”‚  Celery  â”‚      â”‚
â”‚  â”‚  React   â”‚  â”‚  Flask   â”‚  â”‚  Worker  â”‚  â”‚   Beat   â”‚      â”‚
â”‚  â”‚  :3001   â”‚  â”‚  :5002   â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
â”‚       â”‚             â”‚             â”‚             â”‚             â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                     â”‚             â”‚                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                     â”‚
â”‚              â”‚  PostgreSQL â”‚ â”‚  Redis  â”‚                     â”‚
â”‚              â”‚    :5432    â”‚ â”‚  :6379  â”‚                     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MediaMTX Nodes                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Node 1    â”‚  â”‚   Node 2    â”‚  â”‚   Node N    â”‚           â”‚
â”‚  â”‚ Production  â”‚  â”‚   Staging   â”‚  â”‚     Dev     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API åƒè€ƒ

### å¥åº·æª¢æŸ¥

```bash
# å¿«é€Ÿæª¢æŸ¥æ‰€æœ‰ç¯€é»ï¼ˆæ¯«ç§’ç´šï¼‰
POST /api/health/quick-check

# å¿«é€Ÿæª¢æŸ¥å–®ä¸€ç¯€é»
POST /api/health/quick-check/{node_id}

# æ·±åº¦æ¢æ¸¬ä¸²æµï¼ˆffprobeï¼‰
POST /api/health/streams/{stream_id}/probe
```

### ç¯€é»ç®¡ç†

```bash
# åˆ—å‡ºç¯€é»
GET /api/fleet/nodes

# æ–°å¢ç¯€é»
POST /api/fleet/nodes

# åŒæ­¥ç¯€é»ä¸²æµ
POST /api/fleet/nodes/{node_id}/sync

# åŒæ­¥æ‰€æœ‰ç¯€é»
POST /api/fleet/sync-all
```

### ä¸²æµç®¡ç†

```bash
# åˆ—å‡ºä¸²æµ
GET /api/streams

# ä¿®å¾©ä¸²æµ
POST /api/streams/{stream_id}/remediate
```

### éŒ„å½±ç®¡ç†

```bash
# åˆ—å‡ºéŒ„å½±ï¼ˆæ”¯æ´æœå°‹èˆ‡åˆ†é ï¼‰
GET /api/recordings?search=camera1&page=1&per_page=20

# æƒææœ¬åœ°éŒ„å½±ç›®éŒ„
POST /api/recordings/scan
# Request: { "node_id": 1, "force_rescan": false }

# ä¸²æµæ’­æ”¾éŒ„å½±ï¼ˆè‡ªå‹•è½‰æª”ä¾›ç€è¦½å™¨æ’­æ”¾ï¼‰
GET /api/recordings/{id}/stream

# ä¸‹è¼‰éŒ„å½±
GET /api/recordings/{id}/download

# åŸ·è¡Œæ¸…ç†
POST /api/recordings/retention/cleanup
```

### é…ç½®ç®¡ç†

```bash
# Plan é…ç½®è®Šæ›´
POST /api/config/plan

# Apply é…ç½®
POST /api/config/apply

# å›æ»¾é…ç½®
POST /api/config/rollback/{snapshot_id}
```

## è¨­å®š

### ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸ | é è¨­å€¼ | èªªæ˜ |
|------|--------|------|
| `MEDIAMTX_API_URL` | `http://localhost:9998` | MediaMTX API ä½å€ |
| `MEDIAMTX_RTSP_URL` | `rtsp://localhost:8554` | MediaMTX RTSP ä½å€ |
| `DATABASE_URL` | `postgresql://...` | PostgreSQL é€£ç·šå­—ä¸² |
| `REDIS_URL` | `redis://localhost:6379/0` | Redis é€£ç·šå­—ä¸² |

### Docker Compose

ç·¨è¼¯ `docker-compose.yml` ä¿®æ”¹é€£ç·šè¨­å®šï¼š

```yaml
environment:
  - MEDIAMTX_API_URL=http://host.docker.internal:9998
  - MEDIAMTX_RTSP_URL=rtsp://host.docker.internal:8554
```

## æœå‹™åŸ è™Ÿ

| æœå‹™ | åŸ è™Ÿ |
|------|:----:|
| Frontend | 3001 |
| Backend API | 5002 |
| PostgreSQL | 15433 |
| Redis | 6380 |

## å¸¸ç”¨æŒ‡ä»¤

```bash
# å•Ÿå‹•æœå‹™
docker compose up -d

# æŸ¥çœ‹æ—¥èªŒ
docker compose logs -f backend

# é‡å»ºå‰ç«¯
docker compose build frontend && docker compose up -d frontend

# é‡å»ºå¾Œç«¯
docker compose build backend && docker compose up -d backend celery-worker celery-beat

# åœæ­¢æœå‹™
docker compose down

# å®Œå…¨æ¸…é™¤ï¼ˆå«è³‡æ–™åº«ï¼‰
docker compose down -v
```

## ç–‘é›£æ’è§£

### ä¸²æµå…¨éƒ¨é¡¯ç¤ºä¸å¥åº·

ç¢ºèªç¯€é»çš„ RTSP URL è¨­å®šæ­£ç¢ºï¼š

```bash
# æª¢æŸ¥ç¯€é»è¨­å®š
curl http://localhost:5002/api/fleet/nodes | jq '.nodes[] | {name, rtsp_url}'

# æ›´æ–° RTSP URL
curl -X PUT http://localhost:5002/api/fleet/nodes/1 \
  -H "Content-Type: application/json" \
  -d '{"rtsp_url": "rtsp://your-mediamtx:8554"}'
```

### å¥åº·æª¢æŸ¥è¶…æ™‚

Celery ä»»å‹™å·²å„ªåŒ–ç‚ºä¸¦è¡ŒåŸ·è¡Œï¼Œå¦‚ä»æœ‰å•é¡Œï¼š

```bash
# é‡å•Ÿ Celery
docker compose restart celery-worker celery-beat
```

### å‰ç«¯é¡¯ç¤ºèˆŠç‰ˆæœ¬

```bash
# é‡å»ºä¸¦é‡å•Ÿå‰ç«¯
docker compose build frontend && docker compose up -d frontend

# æ¸…é™¤ç€è¦½å™¨å¿«å– (Ctrl+Shift+R)
```

## æˆæ¬Š

MIT License
